# Security Package Environment Variables

# ============================================================================
# AWS KMS Configuration
# ============================================================================
# Required for AWS KMS integration
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your-access-key-id
# AWS_SECRET_ACCESS_KEY=your-secret-access-key
# AWS_KMS_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012

# ============================================================================
# HashiCorp Vault Configuration
# ============================================================================
# Required for Vault KMS integration

# Vault server address
# Development: http://127.0.0.1:8200
# Production: https://vault.production.example.com:8200
VAULT_ADDR=http://127.0.0.1:8200

# Vault authentication token
# Get this from: vault token create -policy=applyforus
VAULT_TOKEN=hvs.your-vault-token-here

# Vault namespace (Vault Enterprise only)
# Leave empty for Vault OSS
VAULT_NAMESPACE=

# Transit secrets engine mount path
# Default: transit
VAULT_TRANSIT_MOUNT=transit

# Default encryption key name
# This is the key that will be used if no key is specified
VAULT_DEFAULT_KEY_NAME=applyforus-encryption

# ============================================================================
# Key Management Configuration
# ============================================================================

# Key rotation period in days (default: 90)
KEY_ROTATION_PERIOD_DAYS=90

# Grace period for old keys in days (default: 30)
KEY_GRACE_PERIOD_DAYS=30

# Enable automatic key rotation (default: true)
KEY_AUTO_ROTATE=true

# Local key storage path (optional)
# If specified, keys will be persisted to this file
# KEY_STORE_PATH=/var/lib/applyforus/keys.json

# ============================================================================
# Encryption Configuration
# ============================================================================

# Default encryption algorithm (default: aes-256-gcm)
ENCRYPTION_ALGORITHM=aes-256-gcm

# Use external KMS (aws|vault|none)
# none: Use local key management
# aws: Use AWS KMS
# vault: Use HashiCorp Vault
EXTERNAL_KMS=vault

# ============================================================================
# Audit Logging Configuration
# ============================================================================

# Audit log storage path
AUDIT_LOG_PATH=/var/log/applyforus/audit.log

# Enable audit logging (default: true)
AUDIT_LOGGING_ENABLED=true

# Audit log retention days (default: 90)
AUDIT_LOG_RETENTION_DAYS=90

# ============================================================================
# RBAC Configuration
# ============================================================================

# Enable strict permission checking (default: true)
RBAC_STRICT_MODE=true

# Cache permission checks (default: true)
RBAC_CACHE_ENABLED=true

# Permission cache TTL in seconds (default: 300)
RBAC_CACHE_TTL=300
