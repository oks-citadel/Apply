# ============================================================================
# Production Environment ConfigMap
# ============================================================================
# Non-sensitive configuration for production environment
# All secrets are managed via Azure Key Vault + CSI Driver
# ============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: applyforus-config
  namespace: applyforus
  labels:
    app: applyforus-platform
    environment: production
data:
  # ============================================================================
  # Environment Configuration
  # ============================================================================
  NODE_ENV: "production"
  ENVIRONMENT: "production"
  LOG_LEVEL: "info"

  # ============================================================================
  # Application URLs
  # ============================================================================
  API_BASE_URL: "https://api.applyforus.com"
  WEB_BASE_URL: "https://applyforus.com"
  FRONTEND_URL: "https://applyforus.com"
  APP_URL: "https://applyforus.com"

  # ============================================================================
  # CORS Configuration
  # ============================================================================
  CORS_ORIGINS: "https://applyforus.com,https://www.applyforus.com,https://api.applyforus.com"
  CORS_ALLOW_CREDENTIALS: "true"

  # ============================================================================
  # Service Discovery (Internal Kubernetes DNS)
  # ============================================================================
  AI_SERVICE_URL: "http://ai-service.applyforus.svc.cluster.local:8000"
  AUTH_SERVICE_URL: "http://auth-service.applyforus.svc.cluster.local:4000"
  USER_SERVICE_URL: "http://user-service.applyforus.svc.cluster.local:4001"
  RESUME_SERVICE_URL: "http://resume-service.applyforus.svc.cluster.local:4002"
  JOB_SERVICE_URL: "http://job-service.applyforus.svc.cluster.local:4003"
  AUTO_APPLY_SERVICE_URL: "http://auto-apply-service.applyforus.svc.cluster.local:4004"
  ANALYTICS_SERVICE_URL: "http://analytics-service.applyforus.svc.cluster.local:4005"
  NOTIFICATION_SERVICE_URL: "http://notification-service.applyforus.svc.cluster.local:4006"
  ORCHESTRATOR_SERVICE_URL: "http://orchestrator-service.applyforus.svc.cluster.local:4007"
  PAYMENT_SERVICE_URL: "http://payment-service.applyforus.svc.cluster.local:4008"

  # ============================================================================
  # Service Ports
  # ============================================================================
  AI_SERVICE_PORT: "8000"
  AUTH_SERVICE_PORT: "4000"
  USER_SERVICE_PORT: "4001"
  RESUME_SERVICE_PORT: "4002"
  JOB_SERVICE_PORT: "4003"
  AUTO_APPLY_SERVICE_PORT: "4004"
  ANALYTICS_SERVICE_PORT: "4005"
  NOTIFICATION_SERVICE_PORT: "4006"
  ORCHESTRATOR_SERVICE_PORT: "4007"
  PAYMENT_SERVICE_PORT: "4008"
  WEB_PORT: "3000"

  # ============================================================================
  # Database Configuration (non-sensitive)
  # ============================================================================
  POSTGRES_HOST: "applyforus-postgres.postgres.database.azure.com"
  POSTGRES_PORT: "5432"
  POSTGRES_DB: "applyforus"
  POSTGRES_SSL: "true"
  DATABASE_SSL: "true"

  # ============================================================================
  # Redis Configuration (non-sensitive)
  # ============================================================================
  REDIS_HOST: "applyforus-redis.redis.cache.windows.net"
  REDIS_PORT: "6380"
  REDIS_DB: "0"
  REDIS_TLS: "true"
  REDIS_SSL: "true"

  # ============================================================================
  # JWT Configuration (non-sensitive)
  # ============================================================================
  JWT_EXPIRES_IN: "24h"
  JWT_EXPIRATION: "24h"
  JWT_REFRESH_EXPIRES_IN: "7d"
  JWT_REFRESH_EXPIRATION: "7d"

  # ============================================================================
  # Session Configuration
  # ============================================================================
  SESSION_EXPIRATION: "86400000"
  SESSION_MAX_AGE: "86400000"

  # ============================================================================
  # Rate Limiting (More restrictive for production)
  # ============================================================================
  RATE_LIMIT_WINDOW: "60"
  RATE_LIMIT_MAX: "60"
  RATE_LIMIT_WINDOW_MS: "900000"
  RATE_LIMIT_MAX_REQUESTS: "60"

  # ============================================================================
  # AI Configuration
  # ============================================================================
  OPENAI_MODEL: "gpt-4-turbo-preview"
  OPENAI_MAX_TOKENS: "4096"
  ANTHROPIC_MODEL: "claude-3-opus-20240229"
  AI_SUGGESTIONS_ENABLED: "true"
  RESUME_OPTIMIZATION_ENABLED: "true"
  SALARY_PREDICTION_ENABLED: "true"

  # ============================================================================
  # Email Configuration
  # ============================================================================
  EMAIL_FROM: "noreply@applyforus.com"
  EMAIL_FROM_NAME: "ApplyForUs Platform"
  EMAIL_PROVIDER: "sendgrid"
  NOTIFICATIONS_ENABLED: "true"

  # ============================================================================
  # File Upload Configuration
  # ============================================================================
  MAX_FILE_SIZE: "5242880"
  ALLOWED_FILE_TYPES: "application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain"
  ALLOWED_FILE_EXTENSIONS: ".pdf,.doc,.docx,.txt"
  ALLOWED_IMAGE_TYPES: "image/jpeg,image/png,image/webp"

  # ============================================================================
  # Feature Flags
  # ============================================================================
  FEATURE_AUTO_APPLY: "true"
  FEATURE_AI_RESUME_BUILDER: "true"
  FEATURE_ANALYTICS_DASHBOARD: "true"
  FEATURE_CHROME_EXTENSION: "true"

  # ============================================================================
  # Processing Limits (Lower for production stability)
  # ============================================================================
  MAX_CONCURRENT_JOBS: "5"
  MAX_APPLICATIONS_PER_DAY: "100"
  JOB_PROCESSING_TIMEOUT: "300000"
  MAX_RETRY_ATTEMPTS: "3"
  MAX_UPLOADS_PER_DAY: "20"
  MAX_DOWNLOADS_PER_DAY: "100"

  # ============================================================================
  # Caching Configuration
  # ============================================================================
  CACHE_TTL: "600"
  CACHE_MAX_ITEMS: "5000"
  REDIS_TTL: "7200"

  # ============================================================================
  # Browser Automation
  # ============================================================================
  BROWSER_HEADLESS: "true"
  HEADLESS_BROWSER: "true"
  BROWSER_TIMEOUT: "30000"
  ACTION_DELAY: "1000"
  VIEWPORT_WIDTH: "1920"
  VIEWPORT_HEIGHT: "1080"

  # ============================================================================
  # Monitoring Configuration
  # ============================================================================
  ENABLE_METRICS: "true"
  METRICS_PORT: "9090"
  ENABLE_ANALYTICS: "true"
  ANALYTICS_RETENTION_DAYS: "90"

  # ============================================================================
  # Version Control
  # ============================================================================
  ENABLE_VERSION_CONTROL: "true"
  MAX_VERSIONS_PER_RESUME: "10"
