# ============================================================================
# AUTH SERVICE - Environment Configuration
# ============================================================================
# This file contains all environment variables for the authentication service.
# Copy this file to .env and update with your actual values.
#
# Required variables are marked with [REQUIRED]
# Optional variables are marked with [OPTIONAL]
# ============================================================================

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# [REQUIRED] Runtime environment
# Values: development | production | test
NODE_ENV=development

# [REQUIRED] Service port number
PORT=8001

# [OPTIONAL] API route prefix
API_PREFIX=api/v1

# ============================================================================
# DATABASE - PostgreSQL
# ============================================================================
# Production: Azure Database for PostgreSQL (SSL required)
# Local Dev: Use localhost:5432 or Docker Compose
# ============================================================================

# [REQUIRED] Full PostgreSQL connection string
# Format: postgresql://username:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://applyforusadmin@applyforus-postgres:${DB_PASSWORD}@applyforus-postgres.postgres.database.azure.com:5432/applyforus?sslmode=require

# Alternative: Individual database configuration
# [REQUIRED] Database host
DB_HOST=applyforus-postgres.postgres.database.azure.com

# [REQUIRED] Database port
DB_PORT=5432

# [REQUIRED] Database username
DB_USERNAME=applyforusadmin@applyforus-postgres

# [REQUIRED] Database password - CHANGE IN PRODUCTION
DB_PASSWORD=<your-db-password-here>

# [REQUIRED] Database name
DB_DATABASE=applyforus

# [REQUIRED] Enable SSL for database connection (always true in production)
DB_SSL=true

# --- Local Development Override (use in .env.local) ---
# DATABASE_URL=postgresql://postgres:postgres@localhost:5432/auth_service_db
# DB_HOST=localhost
# DB_USERNAME=postgres
# DB_PASSWORD=postgres
# DB_SSL=false

# ============================================================================
# JWT CONFIGURATION
# ============================================================================
# SECURITY WARNING: Change all secrets in production!
# Generate strong secrets with: openssl rand -base64 64
# ============================================================================

# [REQUIRED] Secret key for signing JWT access tokens
# MUST be at least 32 characters
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars

# [REQUIRED] Access token expiration time
# Recommended: 15m for web apps (short-lived for security)
# Values: 15m, 30m, 1h, 24h
JWT_ACCESS_TOKEN_EXPIRY=15m

# [REQUIRED] Secret key for refresh tokens
# MUST be different from JWT_SECRET
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production-min-32-chars

# [REQUIRED] Refresh token expiration time
# Recommended: 7d for web apps, 30d for mobile apps
JWT_REFRESH_EXPIRES_IN=7d

# [OPTIONAL] JWT issuer identifier
JWT_ISSUER=applyforus-auth-service

# [OPTIONAL] JWT audience identifier
JWT_AUDIENCE=applyforus-platform

# ============================================================================
# OAUTH PROVIDERS - Google
# ============================================================================
# Obtain credentials from: https://console.cloud.google.com/apis/credentials
# See ops/docs/environment-setup.md for detailed setup instructions
# ============================================================================

# [REQUIRED for OAuth] Google OAuth Client ID
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com

# [REQUIRED for OAuth] Google OAuth Client Secret
GOOGLE_CLIENT_SECRET=your-google-client-secret

# [REQUIRED for OAuth] Google OAuth callback URL
# Production: https://api.applyforus.com/api/v1/auth/google/callback
# Local Dev: http://localhost:8001/api/v1/auth/google/callback
GOOGLE_CALLBACK_URL=https://api.applyforus.com/api/v1/auth/google/callback

# ============================================================================
# OAUTH PROVIDERS - GitHub
# ============================================================================
# Obtain credentials from: https://github.com/settings/developers
# See ops/docs/environment-setup.md for detailed setup instructions
# ============================================================================

# [REQUIRED for OAuth] GitHub OAuth Client ID
GITHUB_CLIENT_ID=your-github-client-id

# [REQUIRED for OAuth] GitHub OAuth Client Secret
GITHUB_CLIENT_SECRET=your-github-client-secret

# [REQUIRED for OAuth] GitHub OAuth callback URL
# Production: https://api.applyforus.com/api/v1/auth/github/callback
# Local Dev: http://localhost:8001/api/v1/auth/github/callback
GITHUB_CALLBACK_URL=https://api.applyforus.com/api/v1/auth/github/callback

# ============================================================================
# OAUTH PROVIDERS - LinkedIn
# ============================================================================
# Obtain credentials from: https://www.linkedin.com/developers/apps
# See ops/docs/environment-setup.md for detailed setup instructions
# ============================================================================

# [REQUIRED for OAuth] LinkedIn OAuth Client ID
LINKEDIN_CLIENT_ID=your-linkedin-client-id

# [REQUIRED for OAuth] LinkedIn OAuth Client Secret
LINKEDIN_CLIENT_SECRET=your-linkedin-client-secret

# [REQUIRED for OAuth] LinkedIn OAuth callback URL
# Production: https://api.applyforus.com/api/v1/auth/linkedin/callback
# Local Dev: http://localhost:8001/api/v1/auth/linkedin/callback
LINKEDIN_CALLBACK_URL=https://api.applyforus.com/api/v1/auth/linkedin/callback

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
# Production: Azure Cache for Redis (SSL/TLS on port 6380)
# Local Dev: Use localhost:6379 or Docker Compose
# Used for: Session management, token blacklisting, rate limiting
# ============================================================================

# [REQUIRED] Redis host
REDIS_HOST=applyforus-redis.redis.cache.windows.net

# [REQUIRED] Redis port (6380 for Azure SSL, 6379 for local)
REDIS_PORT=6380

# [REQUIRED] Redis access key/password
REDIS_PASSWORD=<your-redis-access-key-here>

# [OPTIONAL] Redis database number (0-15)
REDIS_DB=0

# [REQUIRED] Enable TLS for Redis connection (always true in production)
REDIS_TLS=true

# [OPTIONAL] Enable SSL (alias for TLS)
REDIS_SSL=true

# [OPTIONAL] Redis key TTL in seconds (default: 1 hour)
REDIS_TTL=3600

# --- Local Development Override (use in .env.local) ---
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_TLS=false
# REDIS_SSL=false

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
# Used for: Email verification, password reset
# Providers: Gmail, SendGrid, Mailgun, Outlook
# For Gmail: Use App Password (https://myaccount.google.com/apppasswords)
# ============================================================================

# [REQUIRED] SMTP server host
# Gmail: smtp.gmail.com
# SendGrid: smtp.sendgrid.net
# Mailgun: smtp.mailgun.org
EMAIL_HOST=smtp.gmail.com

# [REQUIRED] SMTP server port
# Port 587 for TLS, Port 465 for SSL
EMAIL_PORT=587

# [OPTIONAL] Use secure connection (false for TLS on port 587)
EMAIL_SECURE=false

# [REQUIRED] SMTP username/email
EMAIL_USER=your-email@gmail.com

# [REQUIRED] SMTP password or app-specific password
EMAIL_PASS=your-app-specific-password

# [REQUIRED] From email address for outgoing emails
EMAIL_FROM=noreply@applyforus.com

# [OPTIONAL] Email verification token expiry in seconds (default: 24 hours)
EMAIL_VERIFICATION_EXPIRY=86400

# [OPTIONAL] Password reset token expiry in seconds (default: 1 hour)
PASSWORD_RESET_EXPIRY=3600

# --- Legacy SMTP variables (for backward compatibility) ---
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# Production: Use your actual domain names
# Local Dev: Use localhost URLs
# ============================================================================

# [REQUIRED] Comma-separated list of allowed origins
CORS_ORIGINS=https://applyforus.com,https://www.applyforus.com,https://api.applyforus.com

# [OPTIONAL] Allow credentials in CORS requests
CORS_ALLOW_CREDENTIALS=true

# --- Local Development Override (use in .env.local) ---
# CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ============================================================================
# RATE LIMITING
# ============================================================================

# [OPTIONAL] Rate limit window in milliseconds (default: 1 minute)
THROTTLE_TTL=60000

# [OPTIONAL] Maximum requests per window
THROTTLE_LIMIT=100

# ============================================================================
# PASSWORD POLICY & SECURITY
# ============================================================================

# [OPTIONAL] Minimum password length (recommended: 8-12)
MIN_PASSWORD_LENGTH=8

# [OPTIONAL] Bcrypt salt rounds (recommended: 10-12)
# Higher = more secure but slower
BCRYPT_ROUNDS=12

# [OPTIONAL] Max failed login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# [OPTIONAL] Account lockout duration in seconds (default: 15 minutes)
LOCKOUT_DURATION=900

# [OPTIONAL] Password complexity requirements
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true

# ============================================================================
# SESSION CONFIGURATION
# ============================================================================

# [REQUIRED] Session secret for cookies - CHANGE IN PRODUCTION
# Generate with: openssl rand -base64 64
SESSION_SECRET=your-session-secret-change-in-production-min-32-chars

# [OPTIONAL] Session max age in milliseconds (default: 24 hours)
SESSION_MAX_AGE=86400000

# ============================================================================
# CSRF PROTECTION
# ============================================================================

# [OPTIONAL] Enable CSRF protection for state-changing operations
CSRF_ENABLED=true

# [REQUIRED if CSRF enabled] CSRF token secret - CHANGE IN PRODUCTION
CSRF_SECRET=your-csrf-secret-change-in-production-min-32-chars

# ============================================================================
# SECURITY HEADERS
# ============================================================================

# [OPTIONAL] Enable Helmet security headers middleware
HELMET_ENABLED=true

# [OPTIONAL] Enable HTTP Strict Transport Security
HSTS_ENABLED=true

# [OPTIONAL] HSTS max age in seconds (default: 1 year)
HSTS_MAX_AGE=31536000

# ============================================================================
# TWO-FACTOR AUTHENTICATION (2FA)
# ============================================================================

# [OPTIONAL] Application name shown in 2FA authenticator apps
TWO_FACTOR_APP_NAME=ApplyForUs

# ============================================================================
# EXTERNAL SERVICES
# ============================================================================
# Production: Use Kubernetes internal DNS
# Local Dev: Use localhost URLs
# ============================================================================

# [OPTIONAL] User service URL for inter-service communication
USER_SERVICE_URL=http://user-service.applyforus.svc.cluster.local:8002

# [OPTIONAL] Job service URL
JOB_SERVICE_URL=http://job-service.applyforus.svc.cluster.local:8004

# --- Local Development Override (use in .env.local) ---
# USER_SERVICE_URL=http://localhost:8002/api/v1
# JOB_SERVICE_URL=http://localhost:8004/api/v1

# ============================================================================
# LOGGING
# ============================================================================

# [OPTIONAL] Log level (error, warn, info, debug)
LOG_LEVEL=debug

# ============================================================================
# NOTES
# ============================================================================
# 1. Never commit .env files to version control
# 2. Use strong, random values for all secrets in production
# 3. Generate secrets with: openssl rand -base64 64
# 4. For production, use Azure Key Vault for secret management
# 5. Token storage recommendations:
#    - Store access tokens in memory (not localStorage)
#    - Store refresh tokens in httpOnly, secure cookies
#    - Always use HTTPS in production
# ============================================================================
