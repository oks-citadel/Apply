# ============================================================================
# PAYMENT SERVICE - Environment Configuration
# ============================================================================
# This file contains all environment variables for the payment service.
# Copy this file to .env and update with your actual values.
#
# Required variables are marked with [REQUIRED]
# Optional variables are marked with [OPTIONAL]
# ============================================================================

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# [REQUIRED] Runtime environment
# Values: development | production | test
NODE_ENV=development

# [REQUIRED] Service port number
PORT=3000

# [OPTIONAL] Service name identifier
SERVICE_NAME=payment-service

# ============================================================================
# DATABASE - PostgreSQL
# ============================================================================
# Production: Azure Database for PostgreSQL (SSL required)
# Local Dev: Use localhost:5432 or Docker Compose
# ============================================================================

# [REQUIRED] Database host
DB_HOST=localhost

# [REQUIRED] Database port
DB_PORT=5432

# [REQUIRED] Database username
DB_USERNAME=postgres

# [REQUIRED] Database password - CHANGE IN PRODUCTION
DB_PASSWORD=postgres

# [REQUIRED] Database name
DB_DATABASE=payment_service

# [OPTIONAL] Auto-sync database schema (NEVER use in production)
DB_SYNCHRONIZE=false

# [OPTIONAL] Enable SQL query logging
DB_LOGGING=false

# --- Production Override ---
# DB_HOST=applyforus-postgres.postgres.database.azure.com
# DB_USERNAME=applyforusadmin@applyforus-postgres
# DB_PASSWORD=<your-db-password-here>
# DB_DATABASE=payment_service
# DB_SSL=true

# ============================================================================
# STRIPE - Primary Payment Provider
# ============================================================================
# Obtain credentials from: https://dashboard.stripe.com/apikeys
# Test mode: Use sk_test_* and pk_test_* keys
# Live mode: Use sk_live_* and pk_live_* keys
# See ops/docs/environment-setup.md for detailed setup instructions
# ============================================================================

# [REQUIRED] Stripe secret API key
# Format: sk_test_... (test) or sk_live_... (production)
STRIPE_SECRET_KEY=sk_test_your_secret_key

# [REQUIRED] Stripe publishable API key
# Format: pk_test_... (test) or pk_live_... (production)
STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key

# [REQUIRED] Stripe webhook signing secret
# Get this from: Dashboard > Developers > Webhooks > Signing secret
# Format: whsec_...
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# [REQUIRED] Stripe price IDs for subscription plans
# Create these in: Dashboard > Products > Add product
STRIPE_BASIC_PRICE_ID=price_basic_monthly
STRIPE_PRO_PRICE_ID=price_pro_monthly
STRIPE_ENTERPRISE_PRICE_ID=price_enterprise_monthly

# ============================================================================
# STRIPE TAX - Automatic Tax Calculation (Optional)
# ============================================================================
# Enable Stripe Tax for automatic VAT/GST calculation
# Requires: Stripe Tax subscription from Stripe Dashboard
# Handles: EU VAT, UK VAT, AU/NZ GST, US Sales Tax, Canadian GST
# See: https://stripe.com/docs/tax
# ============================================================================

# [OPTIONAL] Enable Stripe Tax automatic calculation
# When enabled, Stripe automatically calculates and collects appropriate taxes
# based on customer location, your business registration, and product type
STRIPE_TAX_ENABLED=false

# [OPTIONAL] Your business registration country (ISO 3166-1 alpha-2)
# Used for determining tax obligations and reverse charge eligibility
STRIPE_TAX_ORIGIN_COUNTRY=US

# ============================================================================
# PAYSTACK - African Payment Provider (Optional)
# ============================================================================
# Obtain credentials from: https://dashboard.paystack.com/#/settings/developer
# Used for: Nigerian Naira, Ghanaian Cedi, South African Rand
# ============================================================================

# [OPTIONAL] Paystack secret key
# Format: sk_test_... (test) or sk_live_... (production)
PAYSTACK_SECRET_KEY=sk_test_your_secret_key

# [OPTIONAL] Paystack public key
# Format: pk_test_... (test) or pk_live_... (production)
PAYSTACK_PUBLIC_KEY=pk_test_your_public_key

# ============================================================================
# FLUTTERWAVE - African Payment Provider (Optional)
# ============================================================================
# Obtain credentials from: https://dashboard.flutterwave.com/dashboard/settings/apis
# Used for: Multiple African currencies, mobile money
# ============================================================================

# [OPTIONAL] Flutterwave secret key
# Format: FLWSECK_TEST-... (test) or FLWSECK-... (production)
FLUTTERWAVE_SECRET_KEY=FLWSECK_TEST-your_secret_key

# [OPTIONAL] Flutterwave public key
# Format: FLWPUBK_TEST-... (test) or FLWPUBK-... (production)
FLUTTERWAVE_PUBLIC_KEY=FLWPUBK_TEST-your_public_key

# [OPTIONAL] Flutterwave encryption key for card payments
FLUTTERWAVE_ENCRYPTION_KEY=FLWSECK_TEST-your_encryption_key

# [OPTIONAL] Flutterwave webhook secret hash for verification
FLUTTERWAVE_WEBHOOK_SECRET=your_webhook_secret_hash

# ============================================================================
# MESSAGE QUEUE - RabbitMQ (Development) / Azure Service Bus (Production)
# ============================================================================
# Development: RabbitMQ via Docker Compose
# Production: Azure Service Bus for managed messaging
# ============================================================================

# --- RabbitMQ (Development Only) ---

# [REQUIRED for Dev] RabbitMQ connection URL
RABBITMQ_URL=amqp://guest:guest@localhost:5672

# [OPTIONAL] Queue names for event publishing
RABBITMQ_QUEUE_PAYMENT_EVENTS=payment_events
RABBITMQ_QUEUE_SUBSCRIPTION_EVENTS=subscription_events

# --- Azure Service Bus (Production) ---
# [REQUIRED for Prod] Azure Service Bus connection string
# AZURE_SERVICE_BUS_CONNECTION_STRING=Endpoint=sb://applyforus-servicebus.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=<your-key>
# AZURE_SERVICE_BUS_QUEUE_NAME=payment-events

# ============================================================================
# LOGGING
# ============================================================================

# [OPTIONAL] Log level (error, warn, info, debug)
LOG_LEVEL=info

# [OPTIONAL] Log directory for file logging
LOG_DIR=./logs

# ============================================================================
# CORS CONFIGURATION
# ============================================================================

# [REQUIRED] Allowed origin for CORS
# Production: Use your frontend domain
CORS_ORIGIN=http://localhost:3001

# --- Production Override ---
# CORS_ORIGIN=https://applyforus.com

# ============================================================================
# INTER-SERVICE COMMUNICATION
# ============================================================================

# [OPTIONAL] API key for authenticating requests from other services
# Generate with: openssl rand -base64 32
API_KEY_SECRET=your-secret-api-key-here

# ============================================================================
# REDIS CONFIGURATION (Optional - for caching)
# ============================================================================
# Used for: Payment status caching, idempotency keys
# ============================================================================

# [OPTIONAL] Redis host
# REDIS_HOST=localhost

# [OPTIONAL] Redis port
# REDIS_PORT=6379

# [OPTIONAL] Redis password
# REDIS_PASSWORD=

# --- Production Override ---
# REDIS_HOST=applyforus-redis.redis.cache.windows.net
# REDIS_PORT=6380
# REDIS_PASSWORD=<your-redis-access-key-here>
# REDIS_TLS=true

# ============================================================================
# EXTERNAL SERVICE URLs
# ============================================================================
# Production: Use Kubernetes internal DNS
# Local Dev: Use localhost URLs
# ============================================================================

# [OPTIONAL] Auth service URL for token validation
# AUTH_SERVICE_URL=http://localhost:8001

# [OPTIONAL] User service URL
# USER_SERVICE_URL=http://localhost:8002

# [OPTIONAL] Notification service URL
# NOTIFICATION_SERVICE_URL=http://localhost:8007

# --- Production Override ---
# AUTH_SERVICE_URL=http://auth-service.applyforus.svc.cluster.local:8001
# USER_SERVICE_URL=http://user-service.applyforus.svc.cluster.local:8002
# NOTIFICATION_SERVICE_URL=http://notification-service.applyforus.svc.cluster.local:8007

# ============================================================================
# WEBHOOK CONFIGURATION
# ============================================================================

# [OPTIONAL] Base URL for webhook endpoints (used in payment provider setup)
# Production: https://api.applyforus.com
# WEBHOOK_BASE_URL=http://localhost:3000

# ============================================================================
# MONITORING (Optional)
# ============================================================================

# [OPTIONAL] Enable Prometheus metrics
# ENABLE_METRICS=true

# [OPTIONAL] Metrics endpoint port
# METRICS_PORT=9090

# [OPTIONAL] Azure Application Insights
# APPLICATIONINSIGHTS_CONNECTION_STRING=

# ============================================================================
# NOTES
# ============================================================================
# 1. Never commit .env files with real credentials to version control
# 2. Use test API keys during development (sk_test_*, pk_test_*)
# 3. Switch to live keys only in production (sk_live_*, pk_live_*)
# 4. Set up webhooks in each payment provider dashboard
# 5. For webhook testing locally, use tools like:
#    - Stripe CLI: stripe listen --forward-to localhost:3000/webhooks/stripe
#    - ngrok: ngrok http 3000
# 6. Verify webhook signatures in production for security
# 7. Store sensitive keys in Azure Key Vault for production
# ============================================================================
